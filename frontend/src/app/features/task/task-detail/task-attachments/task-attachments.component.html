@if (!isEditing) {
  <div class="attachments-section">
    <div class="attachment-header">
      <h3 class="section-title">é™„ä»¶</h3>
      <label class="file-upload-label">
        <input
          type="file"
          class="file-input"
          (change)="onFileSelected($event)"
          [disabled]="uploadingAttachment()"
          accept="image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,text/plain,text/csv"
        />
        <span class="file-upload-button">
          {{ uploadingAttachment() ? 'ä¸Šå‚³ä¸­...' : 'ğŸ“ ä¸Šå‚³æª”æ¡ˆ' }}
        </span>
      </label>
    </div>
    
    @if (selectedFile && !uploadingAttachment()) {
      <div class="selected-file-info">
        <span class="selected-file-name">{{ selectedFile.name }}</span>
      </div>
    }

    <!-- é™„ä»¶åˆ—è¡¨ -->
    @if (loadingAttachments()) {
      <div class="loading-attachments">è¼‰å…¥é™„ä»¶ä¸­...</div>
    } @else {
      <div class="attachments-list">
        @for (attachment of attachments(); track attachment.id) {
          <div class="attachment-item">
            <div class="attachment-icon">{{ getFileIcon(attachment.file_type) }}</div>
            <div class="attachment-info">
              <div class="attachment-name" (click)="downloadAttachment(attachment)">
                {{ attachment.file_name }}
              </div>
              <div class="attachment-meta">
                <span class="attachment-size">{{ formatFileSize(attachment.file_size) }}</span>
                <span class="attachment-separator">â€¢</span>
                <span class="attachment-uploader">{{ attachment.user?.fullName || 'æœªçŸ¥ä½¿ç”¨è€…' }}</span>
                <span class="attachment-separator">â€¢</span>
                <span class="attachment-time">{{ formatCommentTime(attachment.uploaded_at) }}</span>
              </div>
            </div>
            <div class="attachment-actions">
              <button class="btn-link" (click)="downloadAttachment(attachment)" title="ä¸‹è¼‰">
                â¬‡ï¸
              </button>
              @if (canDeleteAttachment(attachment)) {
                <button class="btn-link btn-danger-link" (click)="deleteAttachment(attachment.id)" title="åˆªé™¤">
                  ğŸ—‘ï¸
                </button>
              }
            </div>
          </div>
        } @empty {
          <div class="empty-attachments">
            <p>å°šç„¡é™„ä»¶ï¼Œä¸Šå‚³ç¬¬ä¸€å€‹æª”æ¡ˆå§ï¼</p>
          </div>
        }
      </div>
    }
  </div>
}

