<div class="workspace-list-container">
  <header class="workspace-header">
    <div class="header-content">
      <button class="btn-back" (click)="goBack()">â† è¿”å›</button>
      <h1>å·¥ä½œå€</h1>
      <button class="btn-primary" (click)="showCreateModal = true">
        <span>+</span> å»ºç«‹å·¥ä½œå€
      </button>
    </div>
  </header>

  <main class="workspace-main">
    <div class="workspace-grid" *ngIf="workspaces().length > 0; else emptyState">
      <div class="workspace-card" *ngFor="let workspace of workspaces()" [routerLink]="['/workspaces', workspace.id]">
        <div class="workspace-card-header">
          <h3>{{ workspace.name }}</h3>
          <div class="workspace-actions" (click)="$event.stopPropagation()">
            <button class="btn-icon" (click)="editWorkspace(workspace)">âœï¸</button>
            <button class="btn-icon" (click)="deleteWorkspace(workspace.id)" *ngIf="workspace.owner_id === currentUserId">ğŸ—‘ï¸</button>
          </div>
        </div>
        <p class="workspace-description" *ngIf="workspace.description">{{ workspace.description }}</p>
        <div class="workspace-stats">
          <div class="stat-item">
            <span class="stat-label">å°ˆæ¡ˆ</span>
            <span class="stat-value">{{ workspace.project_count || 0 }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">æˆå“¡</span>
            <span class="stat-value">{{ workspace.member_count || 0 }}</span>
          </div>
        </div>
        <div class="workspace-footer">
          <span class="workspace-owner">æ“æœ‰è€…: {{ workspace.owner_name || 'æœªçŸ¥' }}</span>
        </div>
      </div>
    </div>

    <ng-template #emptyState>
      <div class="empty-state">
        <div class="empty-icon">ğŸ“</div>
        <h2>é‚„æ²’æœ‰å·¥ä½œå€</h2>
        <p>å»ºç«‹æ‚¨çš„ç¬¬ä¸€å€‹å·¥ä½œå€ä¾†é–‹å§‹ç®¡ç†å°ˆæ¡ˆ</p>
        <button class="btn-primary" (click)="showCreateModal = true">å»ºç«‹å·¥ä½œå€</button>
      </div>
    </ng-template>
  </main>

  <!-- å»ºç«‹/ç·¨è¼¯å·¥ä½œå€æ¨¡æ…‹æ¡† -->
  <div class="modal-overlay" *ngIf="showCreateModal || editingWorkspace" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ editingWorkspace ? 'ç·¨è¼¯å·¥ä½œå€' : 'å»ºç«‹å·¥ä½œå€' }}</h2>
        <button class="btn-close" (click)="closeModal()">Ã—</button>
      </div>
      <form (ngSubmit)="saveWorkspace()" class="modal-form">
        <div class="form-group">
          <label for="name">åç¨± *</label>
          <input 
            type="text" 
            id="name" 
            [(ngModel)]="workspaceForm.name" 
            name="name"
            required
            placeholder="è¼¸å…¥å·¥ä½œå€åç¨±"
          />
        </div>
        <div class="form-group">
          <label for="description">æè¿°</label>
          <textarea 
            id="description" 
            [(ngModel)]="workspaceForm.description" 
            name="description"
            rows="3"
            placeholder="è¼¸å…¥å·¥ä½œå€æè¿°ï¼ˆé¸å¡«ï¼‰"
          ></textarea>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-secondary" (click)="closeModal()">å–æ¶ˆ</button>
          <button type="submit" class="btn-primary" [disabled]="loading() || !workspaceForm.name">
            {{ loading() ? 'è™•ç†ä¸­...' : (editingWorkspace ? 'æ›´æ–°' : 'å»ºç«‹') }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

